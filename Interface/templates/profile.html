<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Profile</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #f7faff;
      padding: 40px;
    }

    .container {
      max-width: 700px;
      margin: auto;
      background-color: #ffffff;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    h2 {
      color: #003366;
      text-align: center;
      margin-bottom: 30px;
    }

    .profile-pic {
      text-align: center;
      margin-bottom: 20px;
    }

    .profile-pic img {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 50%;
      border: 3px solid #3399ff;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 500;
      margin-bottom: 6px;
      color: #004080;
    }

    .form-group input[type="text"],
    .form-group input[type="email"],
    .form-group input[type="password"] {
      width: 100%;
      padding: 12px;
      border: 1px solid #cfd9e6;
      background-color: #eef3fb;
      border-radius: 4px;
    }

    .form-group input[type="file"] {
      font-family: 'Poppins', sans-serif;
    }

    .readonly-field {
      background-color: #e6f0ff;
      font-weight: 600;
    }

    .submit-btn {
      background-color: #3399ff;
      color: white;
      font-weight: bold;
      padding: 12px 24px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      display: block;
      margin: auto;
    }

    .back-link {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 16px;
  font-weight: bold;
  color: #004080;
  text-decoration: none;
  margin-bottom: 20px;
}

.back-link:hover {
  cursor: pointer;
}

/* ===== Course Select ===== */
#course {
  width: 100%;
  padding: 12px 40px 12px 12px;      /* room for custom arrow */
  border: 1px solid #cfd9e6;
  background: #eef3fb;
  border-radius: 8px;
  font-size: 14px;
  color: #002244;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  transition: border-color .2s, box-shadow .2s, background-color .2s;
  /* custom arrow */
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%23004080' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 18px;
}
#course:hover { background-color: #e9f1ff; }
#course:focus {
  outline: none;
  border-color: #3399ff;
  box-shadow: 0 0 0 3px rgba(51,153,255,.25);
}
#course option[disabled][selected] { color: #7c8aa5; }

/* optgroup & options (browser support varies) */
optgroup { color: #004080; font-weight: 600; }
optgroup option { color: #002244; font-weight: 400; }

/* Make the label show required asterisk (optional) */
.form-group label[for="course"]::after {
  content: " *";
  color: #b00020;
  font-weight: 600;
}

/* ===== “Other” Field Box ===== */
#courseOtherGroup {
  margin-top: 10px;
  padding: 12px;
  background: #f1f6ff;
  border: 1px dashed #b6c7e3;
  border-radius: 8px;
}
#course_other {
  width: 100%;
  padding: 12px;
  border: 1px solid #cfd9e6;
  background: #fff;
  border-radius: 8px;
  font-size: 14px;
  color: #002244;
  transition: border-color .2s, box-shadow .2s;
}
#course_other:focus {
  outline: none;
  border-color: #3399ff;
  box-shadow: 0 0 0 3px rgba(51,153,255,.25);
}

/* Optional subtle help text */
.form-help {
  margin-top: 6px;
  font-size: 12px;
  color: #4d6080;
}



  </style>
</head>
<body>

<div class="container">
    <a href="/" class="back-link">
  <i class="fa fa-caret-left" aria-hidden="true"></i> 
</a>
  <h2>My Profile</h2>

  <form action="/profile/{{ student.student_id }}" method="POST" enctype="multipart/form-data">
    
    <div class="profile-pic">
      <img src="{{ url_for('static', filename=student.photo.split('static/')[1].replace('\\', '/')) }}" alt="Profile Photo">
    </div>

    <div class="form-group">
      <label>Student ID</label>
      <input type="text" value="{{ student.student_id }}" readonly class="readonly-field">
    </div>

    <div class="form-group">
      <label for="name">Name</label>
      <input type="text" id="name" name="name" value="{{ student.name }}" required>
    </div>

    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" id="email" name="email" value="{{ student.email }}" required>
    </div>

    <div class="form-group">
      <label for="password">Password</label>
      <input type="password" id="password" name="password" value="{{ student.password }}" required>
    </div>

    <div class="form-group">
  <label for="course">Course</label>
  <select id="course" name="course" required>
    <option value="" disabled {{ 'selected' if not student.get('course') }}>Select your course</option>

    <optgroup label="Computing">
      <option value="BSc (Hons) Computer Science"
        {{ 'selected' if student.get('course') == 'BSc (Hons) Computer Science' }}>BSc (Hons) Computer Science</option>
      <option value="BSc (Hons) Information Systems"
        {{ 'selected' if student.get('course') == 'BSc (Hons) Information Systems' }}>BSc (Hons) Information Systems</option>
      <option value="Diploma in Computer Science"
        {{ 'selected' if student.get('course') == 'Diploma in Computer Science' }}>Diploma in Computer Science</option>
    </optgroup>

    <optgroup label="Engineering">
      <option value="BEng (Hons) Electrical & Electronic"
        {{ 'selected' if student.get('course') == 'BEng (Hons) Electrical & Electronic' }}>BEng (Hons) Electrical & Electronic</option>
      <option value="BEng (Hons) Mechanical"
        {{ 'selected' if student.get('course') == 'BEng (Hons) Mechanical' }}>BEng (Hons) Mechanical</option>
    </optgroup>

    <optgroup label="Business">
      <option value="BBA (Hons)"
        {{ 'selected' if student.get('course') == 'BBA (Hons)' }}>BBA (Hons)</option>
      <option value="BCom (Hons) Accounting"
        {{ 'selected' if student.get('course') == 'BCom (Hons) Accounting' }}>BCom (Hons) Accounting</option>
    </optgroup>

    {% set known = KNOWN_COURSES or [] %}
    <option value="Other"
      {{ 'selected' if student.get('course') and student.get('course') not in known else '' }}>Other</option>
  </select>
</div>

<div class="form-group" id="courseOtherGroup"
     style="display: {{ 'block' if student.get('course') and student.get('course') not in KNOWN_COURSES else 'none' }};">
  <label for="course_other">Specify Course</label>
  <input type="text" id="course_other" name="course_other"
         value="{{ student.get('course') if student.get('course') and student.get('course') not in KNOWN_COURSES else '' }}">
</div>


    

    <div class="form-group">
      <label for="photo">Change Profile Photo</label>
      <input type="file" id="photo" name="photo" accept="image/*">
    </div>

    <hr style="margin: 40px 0;">

    <div class="profile-pic">
      <h3>Your QR Code</h3>
      <img src="{{ url_for('static', filename=qr_code_url) }}" alt="QR Code" style=" border: 1px solid #ccc; padding: 5px; background: white; border-radius: 0;">
      <p style="color: #666; font-size: 14px;">Scan this QR code to verify student identity</p>
    </div>


    <button type="submit" class="submit-btn">Save Changes</button>
  </form>
</div>


<script>
  (function () {
    const select = document.getElementById('course');
    const otherGroup = document.getElementById('courseOtherGroup');
    const otherInput = document.getElementById('course_other');

    function syncOther() {
      if (select.value === 'Other') {
        otherGroup.style.display = 'block';
        if (otherInput) otherInput.required = true;
      } else {
        otherGroup.style.display = 'none';
        if (otherInput) {
          otherInput.required = false;
          // optional: clear when changing away from Other
          // otherInput.value = '';
        }
      }
    }

    if (select) {
      select.addEventListener('change', syncOther);
      // run once in case the page loaded with "Other" selected
      syncOther();
    }
  })();
</script>


</body>
</html>
